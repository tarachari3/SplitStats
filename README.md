# SplitStats

R Package for Analysis of Neighbor Net (NNet) Generated Split Networks.
Adapted from the splitspy NNet implementation in [1].


## Getting Started

These instructions will get you a copy of the project up and running on your local machine for development and testing purposes.

### Prerequisites

R (>= 4.1) and Python (>= 3.6) is necessary for analysis:

R can be downloaded [here](https://cran.r-project.org/mirrors.html)

The RStudio IDE can be downloaded [here](https://rstudio.com/products/rstudio/download/)

### Initial Setup

To install this package start R and enter:
```
if (!requireNamespace("BiocManager", quietly = TRUE))
    install.packages("BiocManager")

BiocManager::install("basilisk")

install.packages("devtools")

```

Install the SplitStats package from github:
```
devtools::install_github("tarachari3/SplitStats")
```
or to see the example vignettes:

```
devtools::install_github("tarachari3/SplitStats", build_vignettes = TRUE)
```


## Running Analysis

To display example vote data and distance matrix:
```
library(SplitStats)

head(votes)
head(dists)
```
<br />
Available functions:
<br /><br />

1. ``` getSplits(labels, mat)```

Given a pairwise distance matrix _mat_ (obs x obs), and a vector row _labels_ (for each input observation obs), output the **circular ordering** of the observations, the **splits comprising their split network** (including the **weights on each split**).
<br /><br />


2. ```getSplitVis(labels, cycle, splits, mat, 'splitgraph.pdf', 'splitnetwork.nex')```

Generates a general phylogenetic outline [1] as below:

<p align="center">
  <img src="https://github.com/tarachari3/SplitStats/blob/main/splitgraph.png" width="40%" height="40%">
</p> 

Pass in a .nex output file as shown above to obtain a SplitsTree GUI compatible output (for greater functionality), as below:
<p align="center">
  <img src="https://github.com/pachterlab/CP_2021/blob/main/116senate.png" width="50%" height="50%">
</p>

<br /><br />


3. ```calcVotPval(votes, labels, names)```

Ranks the contribution of input features (e.g. votes) to a user-defined split, which separates the specific observation _names_ from the remaining _labels_, by generating raw p-values for each input feature.

<br /><br />


4. ```getSplitDist(labels, queries, reference, splits)```

Given a split network with a circular ordering and splits (with associated weights) as generated by _getSplits_ ,
find the distance across the network from which each input in the _queries_ vector is split from the observations in the _reference_ vector.




## Authors

* Tara Chari

## References

[1] Daniel H. Huson, Caner Bagci, Banu Cetinkaya and David Bryant. Phylogenetic context and the use of phylogenetic outlines. Manuscript in preparation (2021)
